<script>
    const urlCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTpSTfK25-ua58vCKKZ7IxNGn4ZQ2EaoqOD261M4fhTJkvA-slW2kL8hAL5jWTq2rbcSkAhVB5nqekW/pub?output=csv";

    function parseCSV(text) {
        // Esta função ignora vírgulas problemáticas
        const lines = text.split(/\r?\n/);
        return lines.map(line => {
            const result = [];
            let current = '';
            let inQuotes = false;
            for (let char of line) {
                if (char === '"') inQuotes = !inQuotes;
                else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else current += char;
            }
            result.push(current);
            return result;
        });
    }

    async function carregarIAs() {
        try {
            const response = await fetch(urlCSV);
            const text = await response.text();
            const data = parseCSV(text).slice(1); // Pula cabeçalho
            const container = document.getElementById('cards-container');
            
            if (data.length === 0) throw new Error("Sem dados");
            container.innerHTML = ""; 

            data.forEach(col => {
                if (col.length >= 4 && col[1].trim() !== "") {
                    const [profissao, nome, desc, link] = col;
                    container.innerHTML += `
                        <div class="bg-white p-6 rounded-2xl shadow-md border border-slate-200 hover:scale-105 transition-transform duration-300 flex flex-col justify-between text-left">
                            <div>
                                <span class="bg-blue-100 text-blue-700 text-xs font-bold px-3 py-1 rounded-full uppercase">${profissao}</span>
                                <h3 class="text-2xl font-bold mt-4 text-slate-800">${nome}</h3>
                                <p class="text-slate-600 mt-2 mb-6 line-clamp-3">${desc}</p>
                            </div>
                            <a href="${link}" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-xl block text-center font-bold shadow-lg transition mt-auto">Acessar IA</a>
                        </div>
                    `;
                }
            });
        } catch (e) {
            document.getElementById('loading-msg').innerText = "Erro ao carregar dados. Verifique se a planilha está publicada.";
        }
    }
    carregarIAs();
</script>
